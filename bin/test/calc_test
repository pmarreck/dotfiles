#!/usr/bin/env bash

# Test the calc function
test_calc() {
  # Test simple calculation
  assert "$(calc 2*4)" == 8 "simple calculations with calc should work"
  
  # Test calculation with spaces (requires globbing to be off)
  assert "$(calc 4 * 23)" == 92 "simple calculations with calc should not glob (requires globbing to be off)"
  
  # Test recursive function definition
  assert "$(calc "define fac(x) { if (x == 0) return (1); return (fac(x-1) * x); }; fac(5)")" == 120 "recursive functions with calc should work"
  
  # Test piping into calc
  assert "$(echo "define fac(x) { if (x == 0) return (1); return (fac(x-1) * x); }; fac(5)" | calc)" == 120 "piping into calc should work"
}

# Run the test if this script is executed directly
if ! (return 0 2>/dev/null); then
  test_calc
fi
